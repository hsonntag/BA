\chapter{Methodik}
\section{Volumenleitermodellierung}
Um ein BEM-Modell zu erstellen, wurde die Oberfläche des Fötus aus
3D-Ultraschallaufnahmen einer gesunden, freiwilligen Probandin
segmentiert. Bei einem 3D-Ultraschallbild werden gewöhnliche
2D-Ultraschallaufnahmen zusammengefügt, indem die Positionen und
Richtungen aller Aufnahmen gemessen werden, welche anschließend die
Informationen zur korrekten 3D-Bildrekonstruktion liefern. Für die
Segmentierung wurden Stop-Marker für Grenzen und Pass-Marker für
einbezogene Gebiete für den Segmentierungsalgorithmus verwendet. Diese
wurden in Teilvolumen der Ultraschallbilder definiert. Teilweise
mussten die Konturen Schicht für Schicht nachgezeichnet werden um die
Voxel der Oberfläche zu definieren, da die Ultraschallbilder vor allem
in den tieferen Schichten zu verrauscht für eine automatisierte
Segmentierung waren.

Für die Segmentierung des Abdomens wurden 3 Kugeloberflächen mit
unterschiedlichen Radien und Mittelpunkten verwendet, die an die
Ultraschalldaten gefittet wurden. Damit konnte das Abdomen
näherungsweise gut modelliert werden. Die Begrenzung des Abdomens wurde
mit einem Quader von den Dimensionen des vom Ultraschall ausgestrahlten
Raumes modelliert. 

Die Vernix caseosa war in den Ultraschallaufnahmen nicht erkennbar, aus
diesem Grund wurde später bei der Modellbildung eine konstante
Vernixschichtdicke, wie in \cite{a3} verwendet.

Zusätzlich zur Fötussegmentierung wurde analog eine Segementierung des Fötuskopfes erstellt.

\begin{figure}
\begin{center}
\includegraphics[]{BA-img/BA-img98.png}
\end{center}
\caption[Segmentierung (gelb) des Fötus in den verwendeten
Ultraschallbildern mit Pass-Marker (grün).]{Segmentierung (gelb) des
Fötus in den verwendeten Ultraschallbildern mit Pass-Marker (grün). In den Bildern steht L für Links, R für Rechts, A für Anterior und P für Posterior.}
\label{seq:refIllustration0}

\end{figure}


\begin{figure}
\begin{center}
\includegraphics[width=6.77cm,height=6.77cm]{BA-img/fetus+vernix.png}
\includegraphics[width=6.77cm,height=6.77cm]{BA-img/kopf+vernix.png}
\end{center}
\caption[Segmentierungsergebnisse für Fötus mit Vernix caseosa
(links) und Kopf mit Vernix caseosa (rechts) in frontaler Ansicht.]{Segmentierungsergebnisse für Fötus mit Vernix caseosa (links)
und Kopf mit Vernix caseosa (rechts) in frontaler Ansicht. Die Vernix
ist hier hautfarben dargestellt und Fötus bzw. Kopf sind grau.}
\label{seq:refIllustration1}

\end{figure}
Das Segmentierungsergebnis des Fötus wurde durch Anwenden von Smoothing
und Closing mit jeweils 9mm geglättet. Durch anschließende Dilatation
um 4mm beim Fötus und 3mm beim Fötuskopf entstanden die Oberflächen der Vernix caseosa
für Fötus und Kopf (\figurename~\ref{seq:refIllustration1}). 


\begin{figure}
\begin{center}
\includegraphics[width=7.92cm,height=7.99cm]{BA-img/BA-img4.pdf}\includegraphics[width=7.92cm,height=7.99cm]{BA-img/BA-img5.pdf}
\end{center}
\caption[Volumenleitermodell des Fötus mit feiner
Randelementediskretisierung (links) und grober (rechts) in frontaler
Ansicht.]{Volumenleitermodell des Fötus mit feiner
Randelementediskretisierung (links) und grober (rechts) in frontaler
Ansicht.}
\label{seq:refIllustration2}
\end{figure}

Über die Oberflächen der Segmentierungen wurden Dreiecksnetze bestehend
aus Dreiecken mit definierter Dreiecksseitenlänge gelegt. Jedes dieser
Dreiecke wurde in den BEM-Modellen wiederum in 4 planare Unterdreiecke verfeinert um in
diesen Unterdreiecken ein stückweise konstantes Dreieckspotential
verwenden zu können. Für die Erstellung der Dreiecksnetze und die daraus resultierenden BEM-Modelle wurde
CURRY Version 4.6 verwendet.

%\section{Modellierung und Sensorsystem}
Aus den Dreiecksnetzen von Abdomen
(\figurename~\ref{seq:refIllustration3}), Vernix caseosa und Fötus
(\figurename~\ref{seq:refIllustration2}) wurde jeweils ein 3-Schalen
BEM-Modell erstellt, sodass insgesamt 10 verschiedene, in
\tablename~\ref{seq:refTable0} aufgelistete BEM-Modelle enstanden.

BEM-Modelle dienen hier der Beschreibung des magnetischen Feldes in Abhängigkeit
von gegebenen Quellenparametern im Volumenleiter. Die Vorwärtsrechnung ist dabei für die magnetische Flussdichte
$\boldsubformula{b}(\boldsubformula{r},\boldsubformula{r}_{Q})$ an der
Sensorposition $\boldsubformula{r}$, ausgehend von der Quellenposition
$\boldsubformula{r}_{Q}$ eindeutig beschreibbar als

%\begin{center}
\begin{equation}
%\begin{gathered}
\boldsubformula{b}(\boldsubformula{r},\boldsubformula{r}_{Q})=-\mu
_{0}\iiint \boldsubformula{J}_{s}(\boldsubformula{r}_{Q})\times \nabla
g(\boldsubformula{r},\boldsubformula{r}_{Q})\mathit{dV}_{Q}\\+\mu
_{0}\sum _{p=1}^{n}\left[\sigma _{p}^{\text{+}}-\sigma
_{p}^{\text{{}-}}\right]\iint _{S_{p}}\Phi
(\boldsubformula{r}_{Q})\nabla
g(\boldsubformula{r},\boldsubformula{r}_{Q})\times
\boldsubformula{{\tilde {n}}}\mathit{dS}_{Q}
%\end{gathered}
\label{eqn:direkt}
\end{equation}
%\end{center}
\cite{a3}. In dieser Gleichung ist $S_{p}$ die Oberfläche,
welche zwei Schichten der Leitfähigkeiten $\sigma _{p}^{\text{+}}$ und
$\sigma _{p}^{\text{{}-}}$ voneinander trennt. Der nach Außen
gerichtete Normalenvektor der Oberfläche $S_{p}$ wurde mit
$\boldsubformula{{\tilde {n}}}$ bezeichnet. Für das biologische Gewebe
wurde die magnetische Permittivität $\mu _{0}$ des Vakuums angenommen. 
$\boldsubformula{J}_{S}(\boldsubformula{r}_{Q})$ ist die Stromdichte
und $\Phi (\boldsubformula{r}_{Q})$ ist das Potential an der
Dipolposition $\boldsubformula{r}_{Q}$ . Für homogene, isotrope
Kompartimente lässt sich die Greensche Funktion als
$g(\boldsubformula{r},\boldsubformula{r}_{Q})=\frac{\mu _{0}}{4\pi
\|\boldsubformula{r}-\boldsubformula{r}_{Q}\|}$ formulieren \cite{a3}.


\begin{figure}
\begin{center}
\includegraphics[width=7.92cm,height=7.99cm]{BA-img/BA-img6.pdf}\includegraphics[width=7.99cm,height=7.99cm]{BA-img/BA-img7.pdf}
\end{center}
\caption[Volumenleitermodell des Abdomens mit feiner
Randelementediskretisierung (links) und grober
(rechts).]{Volumenleitermodell des Abdomens mit feiner
Randelementediskretisierung (links) und grober (rechts).}
\label{seq:refIllustration3}

\end{figure}

\tablename~\ref{seq:refTable0} zeigt die Kombinationen der Seitenlängen
in den verschiedenen Modellen analog zu \cite{996268}.



Für das Innere jeder entstandenen Schicht wurde eine entsprechende
spezifische elektrische Leitfähigkeit definiert, dabei wurden
Leitfähigkeitswerte analog zu Werten aus \cite{a3} gewählt. In allen
BEM-Modellen wurde für das Abdomen und den Fötus bzw. den Kopf eine
spezifische elektrische Leitfähigkeit von $\sigma _{M}=\sigma_{C}=2\cdot 10^{-1}\frac{S}{m}$ und für die Vernix eine spezifische elektrische Leitfähigkeit von $\sigma _{V}=2\cdot 10^{-6}\frac{S}{m}$ verwendet \footnote[1]{Die Leitfähgikeitswerte sind der Literatur \cite{a3} entnommen, wobei $\sigma _{M}$ für Muskelgewebe, $\sigma _{C}$ für Knorpel und $\sigma _{V}$ für die Vernix caseosa jeweils Messwerte der spezifischen elektrischen Leitfähigkeit bei 37°C in einem Frequenzband von 1 bis 100Hz sind}.
Für die Vorwärtsrechnung und die Lösung des inversen Problems wurden
in den BEM-Modellen stückweise konstante Potentiale der
Unterdreiecke verwendet und es wurde der IPA (isolated problem approach) angewendet. 
Der IPA verringert numerische Ungenauigkeiten bei der Lösung des direkten und inversen Problems, wenn
eine Schicht mit stark abweichender spezifischer elektrischer Leitfähigkeit im Volumenleiter
verwendet wird \cite{16463}, wie es hier durch die Vernix caseosa der Fall ist.

\section{Sensorsystem}
Für die Simulationen und Quellenrekonstruktionen wurde das Argos-200
Sensorsystem virtualisiert, es hat eine feste Sensoranordnung, bestehend
aus einem gleichmäßigen, hexagonalen Gitter, mit 65 Sensortripletts für die Magnetfeldmessung in 3
orthogonalen Raumesrichtungen, also insgesamt 195 Sensoren (\figurename~\ref{seq:refIllustrationSensorArray}). Die Sensoren sind in vier planaren und parallelen Ebenen über dem
Messobjekt angeordnet, wobei die Ebene mit dem geringsten Abstand zum
Objekt die meisten (56) Sensortripletts hat und die obersten zwei Ebenen nur einen Sensor für jede der 3
unabhängigen Feldkomponenten besitzen. Die unterste Ebene hat einen Durchmesser von 23 cm \cite{15341659}. Darüber liegt eine Referenzebene mit 7 Sensoren in einem Abstand von 98 mm \cite{15341659}. Die obersten zwei Ebenen haben einen Abstand von 196 mm und 254 mm über der ersten Sensorebene \cite{15341659}. Software-Gradiometer werten die Daten der 3 oberen Sensorebenen aus \cite{15341659} und nur die untere Ebene dient hier der eigentlichen MEG-Datenerfassung.
\begin{figure}
\begin{center}
\includegraphics[]{BA-img/1477-044X-2-6-2-l.jpg}
\end{center}
\caption[Das ATB SQUID Array Argos 200 besteht aus 195 Magnetfeldsensoren, welche in vier Ebenen in orthogonalen Sensortripletts angeordnet sind.]{Diese Abbildung wurde der Referenz \cite{15341659} entnommen. Das ATB SQUID Array Argos 200 besteht aus 195 Magnetfeldsensoren, welche in vier Ebenen in orthogonalen Sensortripletts angeordnet sind. Die Messfläche jedes Sensors ist ein Quadrat mit einer Seitenlänge von 8 mm.}
\label{seq:refIllustrationSensorArray}
\end{figure}
%der Schätzung der restlichen Rauschleistung in den gemessenen MEG-Kanälen
In dieser Arbeit wurden die oberen Sensorebenen in den
Vorwärtssimulationen einbezogen, aber nicht für die Lösung des inversen
Problems verwendet. Die Sensorfläche, in der der magnetische Fluss gemessen wird, ist quadratisch mit einer Seitenlänge von 8 mm \cite{15341659}. Das Koordinatensystem des Sensorsystems wurde zu dem Koordinatensystem der BEM-Modelle
so ausgerichtet, dass es wie in \figurename~\ref{seq:refIllustrationSensor} dargestellt, über dem mütterlichen Abdomen den Kopf des Fötus in der Mittelachse
des Sensorsystems hat. Die Stärke des gemessenen magnetischen Feldes hängt stark von der Distanz zwischen Quelle und Sensor ab \cite{RevModPhys.65.413}, daher wurde dieser Abstand so gering wie möglich gewählt.


\begin{figure}
\begin{center}
\includegraphics[width=8.721cm,height=8.784cm]{BA-img/BA-img9.pdf}
\end{center}
\caption[BEM-Modell ausgehend von der Segmentierung des
Fötus (hautfarben) mit virtuellem SQUID-Sensorsystem
(blau).]{BEM-Modell ausgehend von der Segmentierung des Fötus
(hautfarben) mit virtuellem SQUID-Sensorsystem (blau).}
\label{seq:refIllustrationSensor}
\end{figure}

\section{Quellenmodell}
%\subsection{Art der Quellen}
Als Quellen wurden bei Vorwärtsberechnungen der magnetischen Felder,
elektrische Einzeldipole an festen Positionen mit fester Richtung definiert.
Zu verschiedenen Zeitpunkten wurden, wie weiter unten beschrieben, verschiedene Dipolpositionen
festgelegt, sodass bei der Vorwärtsrechnung für jeden Zeitpunkt das
Feld eines statischen Dipols berechnet wurde. Für die
Quellenrekonstruktionen in CURRY\TTra wurde, wie unten näher erleutert, ein bewegter Dipol angenommen, da für jeden Zeitpunkt
in den Vorwärtsrechnungen eine andere Dipolposition verwendet wurde.

%\subsection{Volume Points}
Um die Güte der Modelle für Quellen im gesamten Gehirnvolumen des Fötus
vergleichen zu können, wurde ein feines Gitter für Quellenpositionen in
diesem Volumen definiert. Um die minimale Distanz der halben
Dreiecksseitenlänge der Randelemente von Dipol zum nächsten Dreieck sicherzustellen,
wurde die Kopfoberfläche um 5mm erodiert. In das eingeschlossenes
Volumen wurden 1025 Quellen mit einem Abstand von 5mm verteilt. Die
Quellen wurden so verteilt, dass jede Quelle auf der Oberfläche des
eingeschlossenen Volumens einen Abstand von 5mm zu den benachbarten
Quellen hat, so entstanden 495 Oberflächenquellen, die durch die
vorangegangene Erosion einen Abstand von 5mm zur Kopfoberfläche haben.
Die inneren Quellen wurden analog zu den Oberflächenquellen erzeugt,
wobei die Oberfläche bei jedem Schritt wiederum um 6mm erodiert wurde,
bis zu dem Punkt, an dem keine Erosion mehr möglich war, dadurch
entstanden 530 innere Quellen. Insgesamt wurden 6 Quellenschichten im
Kopfvolumen erzeugt, deren Abstand radial jeweils 6mm beträgt und auf
deren Oberfläche Quellen mit einem Abstand von 5mm verteilt sind, wie in \figurename~\ref{seq:refIllustrationPoints} dargestellt.
Für die Berechnung der Quellenpositionen in dem definierten Gehirnvolumen
wurde CURRY\TTra Version 4.6 verwendet.

\begin{figure}
\begin{center}
\includegraphics[width=11.19cm,height=11.16cm]{BA-img/BA-img10.pdf}
\end{center}
\caption[Volumenpunkte (hellgrün) im Volumenleitermodell des
Fötus (hautfarben) und Kopfes (grau).]{Volumenpunkte (hellgrün) im
Volumenleitermodell des Fötus (hautfarben) und Kopfes (grau).}
\label{seq:refIllustrationPoints}
\end{figure}

\section{Erstellung von zwei Segmentierungsgrundlagen: Fötus und Fötuskopf}
Für die zwei inneren Schichten der BEM-Modelle wurde zum einen der gesamte Fötus segmentiert
und zum anderen nur der Fötuskopf. Diese Variation der BEM-Modelle ermöglicht es, den Einfluss von Veränderungen in Form, Größe und Lage der inneren Schichten, welche bei US-Aufnahmen nur grob geschätzt werden können, zu quantifizieren. Für die Segmentierung des gesamten Fötus wurde eine Vorlage von Roland Eichardt verwendet. Die Segmentierung des Fötuskopfes wurde weitestgehend manuell mit Stop- und Pass-Markern erstellt. Dabei werden Bild für Bild in den 3D-US-Aufnahmen die Voxel definiert, die trotz eines hohen Helligkeitswertes zum Kopfvolumen gehören (Pass-Marker) und die, welche die Umrandung ausmachen (Stop-Marker). Die Umrandung ist an vielen Stellen mehrere Voxel Breit, damit keine Löcher zwischen den Schnittbildern entstehen. Für die Segmentierung der Kopfoberfläche wurde nach der Definition aller Stop- und Pass-Marker ein Schwellwertverfahren eingesetzt.
Die segmentierte Kopfoberfläche wird vollständig von der Segmentierung des gesamten Fötus eingeschlossen. Das heißt, der Kopf ist bei der Fötussegmentierung etwas größer als bei der eigentlichen Kopfsegmentierung. 

Das Abdomen wurde nur einmal segmentiert, für die Glättung der Spur des Ultraschallkopfes wurden drei Kugeln in die US-Aufnahmen eingepasst. Alle Segmentierungen wurden mit CURRY\TTra Version 4.6 durchgeführt.

\section{Variation der Randelementediskretisierung}
Ausgehend von den erstellten Oberflächen, wie in \figurename~\ref{seq:refIllustration0} veranschaulicht, wurden BEM-Modelle erstellt, wobei die Dreiecksseitenlängen der Oberflächen in den Modellen variiert
wurden. Dabei wird für jede Schicht eine diskretisierte Oberfläche mit bestimmter Dreiecksseitenlänge gewählt und eine entsprechende spezifische elektrische Leitfähigkeit für das eingeschlossene Kompartiment definiert.
Jedes BEM-Modell, welches in dieser Arbeit erstellt wurde, besteht aus 3
Schichten, der Fötusoberfläche, der Vernixoberfläche und der
Abdomenoberfläche. Das Abdomen ist in den BEM-Modellen die Schicht mit
den wenigsten Unebenheiten und mit der größten Oberfläche, deshalb
wurde eine größere Dreiecksseitenlängen beim Abdomen als bei den 2
inneren Schichten verwendet. Für die Vernix- und die Fötusoberfläche
wurde jeweils die gleiche Dreiecksseitenlänge gewählt, da diese sich
nur wenig unterscheiden. Das gleiche galt auch für die Kopfmodelle. Die
Dreiecksseitenlänge des Referenzmodells wurde für die inneren Schichten
mit 3mm und für das Abdomen mit 12mm festgelegt. Die Variation der
Dreiecksseitenlänge erfolgte bei den inneren Schichten in
2-mm-Schritten und beim Abdomen in 4-mm-Schritten.
\begin{table}
\caption{Übersicht über die Dreiecksseitenlängen in den
einzelnen Modellen.}
\label{seq:refTable0}
\begin{center}
\includegraphics[width=16.018cm,height=6.412cm]{BA-img/BA-img8.pdf}
\end{center}
\end{table}
Der Zusammenhang von Knotenanzahl $K$ und Anzahl der Dreiecek $D$ kann für diese BEM-Modelle durch
\begin{equation}
D = 2 \cdot K - 12
\end{equation}
beschrieben werden.

\section{Variation der Schichtdicke der Vernix caseosa}
Um den Einfluss der Vernixschichtdicke zu überprüfen wurden weitere Oberfläche 
für die Modellierung der Vernix caseosa erstellt. In \cite{a3} wurde die
Vernixschichtdicke mit 2mm bis 3mm angegeben. In den inneren Schichten, welche den Fötuskopf modellieren,
wurde entsprechend eine Schichtdicke von 3mm gewählt. Bei einer Dreiecksseitenlänge von 9mm verursacht eine 
Schichtdicke von 3mm bei der Modellierung des gesamten Fötus jedoch Überschneidungen der Oberflächen aufgrund der groben Diskretisierung. Als minimale Schichtdicke ergab sich eine Dicke von 4mm, welche bei allen verwendeten Diskretisierungen überschneidungsfreie Oberflächen lierferte. Daher beschränkte sich die Variation der Vernixschichtdicke auf die Modellierung des Fötus mit einer Dreiecksseitenlänge von 3mm. Es wurden bei diesem Modell Vernixschichtdicken von 2mm und 3mm modelliert, wie in \tablename~\ref{seq:refTable0} aufgelistet.

\section{Simulation von MEG-Messdaten}
Die MEG-Feldvektoren wurden in CURRY\TTra Version 4.6 für die definierten 1025 Dipolpositionen mit 3
orthogonalen Dipolorientierungen an jeder der 65 Sensorpositionen
simuliert. Die Orientierungen der Dipole waren dabei cranial (nach
oben, zum Schädel), sinistral (nach links) und dorsal (nach hinten, zum
Rücken). Die simulierten Messdaten sind die Ergebnisse der Vorwärtsrechnung
für gegebene Quellenparameter, \dahe die linke Seite der Gleichung \eqref{eqn:direkt}, für jede Sensorposition und Sensorrichtung. In den Simulationen hatten die Einzeldipole eine einheitliche Stärke von $j = 1\mu Amm$.

\begin{figure}
\begin{center}
\includegraphics[width=4.791cm,height=4.791cm]{BA-img/BA-img11.png}\includegraphics[width=4.791cm,height=4.791cm]{BA-img/BA-img12.png}\includegraphics[width=4.791cm,height=4.791cm]{BA-img/BA-img13.png}
\end{center}
\captionof{figure}[Feldbilder einer Simulation mit cranialer
Dipolorientierung im BEM{}-Modell, in den drei Sensorausrichtungen x
(links), y (Mitte) und z (rechts) in frontaler Ansicht.]{Feldbilder
einer Simulation mit cranialer Dipolorientierung im BEM-Modell, in den
drei Sensorausrichtungen x (links), y (Mitte) und z (rechts) in
frontaler Ansicht.}
\label{seq:refIllustrationSim}
\end{figure}
In den Simulationen wurde für jeden Zeitpunkt ein anderer Dipolort
verwendet, sodass eine Zeitreihe mit 1025 verschiedenen Feldbildern
entstand. Die Vorwärtsrechnung wurde für jedes BEM-Modell mit stückweise konstanten
Dreieckspotentialen der Unterdreiecke durchgeführt. In \figurename~\ref{seq:refIllustrationSim} sind Feldbilder
einer Simulation für einen Zeitpunkt \bzw einen Dipol dargestellt.

\section{Lösung des inversen Problems}
Mit den simulierten Messwerten für die Felder des Referenzmodells
(BEM-Modell 0), wurden für jedes Modell Quellenrekonstruktionen
durchgeführt. Dabei wurden als a priori Information die Dipolpositionen
als Startpositionen für den unten beschriebenen Optimierungsalgorithmus vorgegeben. Die eigentliche Rekonstruktion beschränkte sich also auf Dipolorientierung und Dipolstärke. Quellenrekonstruktionen wurden mit
jedem Model für alle drei Dipolorientierungen (cranial, dorsal und
sinistral) durchgeführt.

Die Fragestellung des inversen Problems geht nach \cite{4137694} von der Gleichung

\begin{equation}
\boldsubformula{B}=\boldsubformula{L}\boldsubformula{J}+n
\end{equation}

aus. Dabei ist 
$\boldsubformula{J}=\left(\begin{matrix}\boldsubformula{J}_{S}(\boldsubformula{r}_{\mathit{Q1}})\\\boldsubformula{J}_{S}(\boldsubformula{r}_{\mathit{Q2}})\\\vdots
\\\boldsubformula{J}_{S}(\boldsubformula{r}_{\mathit{QNJ}})\end{matrix}\right)$
 der zu rekonstruierende elektrische Stromdichtevektor, der in dieser
Arbeit nur ein Element besitzt (NJ=1),
$\boldsubformula{B}=\left(\begin{matrix}\boldsubformula{b}(\boldsubformula{r}_{\mathit{Q1}})\\\boldsubformula{b}(\boldsubformula{r}_{\mathit{Q2}})\\\vdots
\\\boldsubformula{b}(\boldsubformula{r}_{\mathit{QNB}})\end{matrix}\right)$
ist der gemessene magnetische Flussdichtevektor, der in dieser Arbeit
56 Elemente enthält (NB=56) und $\boldsubformula{L}$ ist die Lead-field
Matrix. Die Rauschkomponente \textit{n} entfällt in diesem Spezialfall
der simulierten Messdaten. Die Lead-field Matrix wird für die Lösung des inversen Problems invertiert, damit hängt die Genauigkeit der Rekonstruktion bedeutend von der Besetzung dieser Matrix ab. In Anbetracht der Vorgehensweise, dass hier die Dipolpositionen vorgegeben wurden, wird deutlich, dass es sich um ein überbestimmtes Gleichungssystem handelt. Diese Tatsache ist ungewöhnlich, in den meisten realen Fällen der Quellenrekonstruktion in der MEG ist das zu lösende Gleichungssystem stark unterbestimmt \cite{4137694}. Aus diesem Grund und dem normalerweise niedrigen SNR, ist das inverse Problem der MEG-Quellenrekonstruktion oft schlecht gestellt, \dahe es gibt keine eindeutige, stabile Lösung \cite{5512917}. Die Lösung ist sehr empfindlich gegenüber kleinen Änderungen in den Daten und im Volumenleitermodell \cite{5512917}. Für die Lösung des inversen Problems wurde CURRY\TTra Version 4.6 verwendet. Es wurde in CURRY\TTra ein Dipol-Fit (\textit{Dipole Fit}) für Bewegte Dipole (\textit{Moving Dipoles}) angewendet, wobei die Startpositionen (\textit{Seeds}) über die \textit{Localize}-Funktion in CURRY\TTra  vorgegeben wurden. Als Optimierer für die Dipollokalisationen wurde der Simplex-Algorithmus, mit einer Anfagnsschrittweite von 1mm verwendet. Die Dipolpositionen wurden dabei mit einem nichtlinearen, erneuerten Nelder-Mead \cite{NelderMead65} Simplex-Algorithmus bestimmt, wohingegen die Dipolkomponenten Orientierung und Stärke mit linearer Algebra berechnet wurden \cite{CurryRM}. Dabei musste für jede Dipolposition die Lead-field Matrix neu aufgestellt werden \cite{Fuchs20041442}.

\section{Bewertungskriterien}
\subsection{Vorwärtslösung}
Von den Simulierten Feldern wurden jeweils die \textit{relative
difference measures}/\textit{RDM} und Amplitudenfaktoren/\textit{MAG}
zu den jeweiligen Referenzfeldern berechnet. Die Referenzfelder für die
BEM-Modelle der Fötussegmentierung stammten von dem analogen Modell mit
den kleinsten Dreiecksseitenlängen (BEM-Modell 0). Die Felder der
Modelle der Kopfsegmentierung wurden mit den Referenzfeldern für diese
Gruppe von Modellen (von BEM-Modell 4) und mit den Feldern des
höchstaufgelösten Modells der Fötussegmentierung (BEM-Modell 0)
verglichen.

Die erste Kennzahl zur Bewertung der Simulationsergebnisse ist der
\textit{relative difference measure }(\textit{RDM}) der analog zu
\cite{Guellmar2010145} definiert ist als

\begin{equation}
\mathit{RDM}=\sqrt{\sum
_{i=1}^{n}\left(\frac{\mathit{meas}_{i}}{\sum
_{j=1}^{n}{\mathit{meas}_{j}^{2}}}-\frac{\mathit{ref}_{i}}{\sum
_{j=1}^{n}{\mathit{ref}_{j}^{2}}}\right)^{2}},
\end{equation}
wobei $n$ die Anzahl der Sensoren ist und $\mathit{ref}_{i}$ und
$\mathit{meas}_{i}$ die \textit{i}ten Komponenten des simulierten
Feldvektors für das jeweilige Referenzmodell und das abweichende Modell
sind. Der \textit{RDM} ist eine Größe für den topographischen Fehler
(minimaler Fehler: $\mathit{RDM}=0$). Die zweite Differenzgröße ist der
Amplitudenfaktor (\textit{MAG}), wie in \cite{Guellmar2010145} definiert als

\begin{equation}
\mathit{MAG}=\sqrt{\frac{\sum
_{i=1}^{n}{\mathit{meas}_{i}^{2}}}{\sum
_{i=1}^{n}{\mathit{ref}_{i}^{2}}}},
\end{equation}
somit ist der Amplitudenfaktor \textit{MAG} ein Maß für den Fehler der
Amplituden (minimaler Fehler: $\mathit{MAG}=1$).

Die Aufteilung des Fehlers der berechneten Felder in \textit{RDM} und
\textit{MAG} ist daher sinnvoll, da eine Änderung der Amplitude
(\textit{MAG}) die rekonstruierte Dipolstärke beeinflusst aber nicht
die räumliche Lokalisierung, eine Topologieänderung wirkt sich hingegen
immer auf die räumliche Lokalisierung aus \cite{Haueisen1997}. Von den gesuchten
Größen (\textit{RDM} und \textit{MAG}) wurden jeweils der Mittelwert
und die Standardabweichung über alle Zeitschritte und somit über alle
Quellenpositionen ermittelt.

\subsection{Rekonstruktion}
Bei der Quellenrekonstruktion wurden die verwendeten Dipolpositionen
vorgegeben und damit nur die Orientierungen und Amplituden der Dipole
rekonstruiert. Die Bewertung der Orientierungen in den
Rekonstruktionsergebnissen erfolgt über den Winkel $\alpha $ zwischen
den Richtungsvektoren des jeweiligen Simulationsdipols $\vec{s}$ und
des dazugehörigen rekonstruierten Dipols $\vec{r}$ mit dem Zusammenhang

\begin{equation}
\alpha =\arccos \left(\frac{\vec{r}\cdot
\vec{s}}{\left|{\vec{r}}\right|\cdot \left|{\vec{s}}\right|}\right).
\end{equation}
Der Winkel $\alpha $ ist damit ein Maß für den Fehler der
rekonstruierten Dipolrichtung (minimaler Fehler: $\alpha =0$). Der
Amplitudenfaktor für den rekonstruierten Dipol ist der Quotient $a$ aus
den Beträgen des rekonstruierten Dipols und des entsprechenden
Simulationsdipols

\begin{equation}
a=\frac{\left|{\vec{r}}\right|}{\left|{\vec{s}}\right|}
\end{equation}
und gibt den Fehler der rekonstruierten Dipolstärke an (minimaler
Fehler: $a=1$).

Diese Kennzahlen wurden für jeden der 1025 Dipole berechnet.

\subsection{Statistische Auswertung}
Die Bewertungsgrößen (\textit{RDM}, \textit{MAG},  $\alpha $  und
\textit{a}) werden für jeden Dipolort bestimmt und sind damit
vektorielle Größen. 

RDM und MAG-Ergebnisse liegen für alle drei Sensorausrichtungen (x, y
und z) vor, um deren Verteilungen mit Mittelwert und Standardabweichung
zu beschreiben, müssen Erwartungswert  $\mu $ von Mittelwerten

\begin{equation}
\mu =E[\left(\frac{1}{N}\sum _{i=1}^{N}X_{i}\right)]
\end{equation}

und Varianz  $\sigma ^{2}$  von Mittelwerten berechnet werden

\begin{equation}  
\sigma^{2} = V[\left(\frac{1}{N}\sum
_{i=1}^{N}X_{i}\right)]=\frac{1}{N^{2}}\left(\sum _{i=1}^{N}\sum
_{j=1}^{N}\mathit{cov}[X_{i},X_{j}]\right).
\end{equation}
